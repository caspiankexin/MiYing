# è§…å½±è¯é¢‘ç»Ÿè®¡å·¥å…·

ğŸ“…Â ç¼–å†™æ—¥æœŸï¼š2025å¹´2æœˆ24æ—¥
ğŸ‘¨â€ğŸ’»Â ä½œè€…GitHubï¼š@caspiankexin  
ğŸ“¨ ä½œè€…é‚®ç®±ï¼š [è”ç³»æˆ‘](mailto:mirror_flower@outlook.com)  
ğŸ“¢ é¡¹ç›®åœ°å€ï¼š[è§…å½±è¯é¢‘ç»Ÿè®¡å·¥å…·](https://github.com/caspiankexin/MiYing) 
â¬Â ä¸‹è½½åœ°å€ï¼š[èµ„æºä¸‹è½½å¯¼èˆªé¡µ](https://flowus.cn/cckeker/share/85efac3f-a20d-4f36-b68a-410decf4f6da)
âœ³ï¸ è½¬è½½è‡³ï¼šåŸåˆ›

---

## ğŸŒŸ å·¥å…·ä»‹ç»

è§…å½±è¯é¢‘ç»Ÿè®¡å·¥å…·æ˜¯ä¸€æ¬¾ä¸“ä¸ºå¤„ç†æµ·é‡æ–‡æœ¬æ•°æ®è€Œè®¾è®¡çš„åº”ç”¨ç¨‹åºï¼Œç‰¹åˆ«é€‚ç”¨äºå¯¹äººæ°‘æ—¥æŠ¥ç­‰å¤§é‡ä¸­æ–‡æ–‡æœ¬èµ„æ–™è¿›è¡Œå…³é”®è¯é¢‘ç‡åˆ†æã€‚

å¯¹ç»™å®šæ—¶é—´èŒƒå›´å†…ï¼Œå¤šä¸ªå…³é”®è¯åœ¨äººæ°‘æ—¥æŠ¥ä¸­çš„å‡ºç°æ¬¡æ•°è¿›è¡Œç»Ÿè®¡ï¼Œå¹¶å°†ç»Ÿè®¡æ•°æ®ä»¥Excelè¡¨æ ¼çš„å½¢å¼å¯¼å‡ºã€‚

> ä¾‹å¦‚ï¼šæŸ¥è¯¢â€œå±±æ²³ç§€ä¸½â€ã€â€œå±±æ²³ç ´ç¢â€ç­‰è¯æ±‡ï¼Œåœ¨2000-2024å¹´é—´ï¼Œåˆ†åˆ«åœ¨äººæ°‘æ—¥æŠ¥ä¸­è¢«æåŠäº†å¤šå°‘æ¬¡ã€‚

## ğŸ”¥ åŠŸèƒ½äº®ç‚¹
### å¤šå…³é”®è¯ç»Ÿè®¡ï¼š
èƒ½å¤ŸåŒæ—¶å¯¹å¤šä¸ªå…³é”®è¯è¿›è¡Œè¯é¢‘ç»Ÿè®¡ï¼Œæ»¡è¶³ä½ å¤šæ ·åŒ–çš„åˆ†æéœ€æ±‚ã€‚æ¯”å¦‚ï¼Œä½ å¯ä»¥åŒæ—¶è¾“å…¥ â€œç»æµå‘å±•â€â€œç§‘æŠ€åˆ›æ–°â€â€œæ°‘ç”Ÿä¿éšœâ€ ç­‰å…³é”®è¯ï¼Œä¸€æ¬¡æ€§è·å–å®ƒä»¬åœ¨äººæ°‘æ—¥æŠ¥ä¸­çš„å‡ºç°æ¬¡æ•°ã€‚

### æ—¶é—´èŒƒå›´è®¾å®šï¼š
ç”¨æˆ·å¯ä»¥è‡ªç”±é€‰å®šå¹´ä»½æœŸé™ï¼Œä»èµ·å§‹å¹´ä»½åˆ°ç»“æŸå¹´ä»½ï¼Œç²¾å‡†ç»Ÿè®¡å…³é”®è¯åœ¨æ¯å¹´äººæ°‘æ—¥æŠ¥ä¸­çš„è¯é¢‘ã€‚æ— è®ºæ˜¯è¿‘äº”å¹´çš„çƒ­ç‚¹è¿½è¸ªï¼Œè¿˜æ˜¯è¿‘åå¹´çš„è¶‹åŠ¿åˆ†æï¼Œéƒ½èƒ½è½»æ¾å®ç°ã€‚

### æ•°æ®å¯è§†åŒ–è¾“å‡ºï¼š
ç»Ÿè®¡å®Œæˆåï¼Œå·¥å…·ä¼šå°†æ•°æ®ç”Ÿæˆ Excel è¡¨ï¼Œæ–¹ä¾¿ç”¨æˆ·è¿›ä¸€æ­¥å¤„ç†å’Œåˆ†æã€‚æ¸…æ™°çš„è¡¨æ ¼å½¢å¼ï¼Œè®©æ•°æ®ä¸€ç›®äº†ç„¶ï¼Œæ— è®ºæ˜¯åˆ¶ä½œæŠ¥å‘Šè¿˜æ˜¯è¿›è¡Œæ·±å…¥ç ”ç©¶ï¼Œéƒ½æ›´åŠ ä¾¿æ·ã€‚

## ğŸ› ï¸ ä½¿ç”¨åœºæ™¯
| ç ”ç©¶é¢†åŸŸ | åº”ç”¨ç¤ºä¾‹             | æ•°æ®ä»·å€¼       |
| ---- | ---------------- | ---------- |
| èˆ†æƒ…åˆ†æ | è¿½è¸ª"ç¢³ä¸­å’Œ"æ”¿ç­–å…³æ³¨åº¦å˜åŒ–æ›²çº¿ | å‘ç°æ”¿ç­–æ¨è¿›å…³é”®èŠ‚ç‚¹ |
| æ–‡åŒ–ä¼ æ’­ | åˆ†æä¼ ç»Ÿæ–‡åŒ–è¯æ±‡ä½¿ç”¨é¢‘ç‡     | æ­ç¤ºæ–‡åŒ–å¤å…´è¶‹åŠ¿   |
| ç»æµé¢„æµ‹ | ç»Ÿè®¡è¡Œä¸šå…³é”®è¯å¹´åº¦æ›å…‰é‡     | é¢„åˆ¤äº§ä¸šå‘å±•é£å‘æ ‡  |

## ğŸ’¡ç¼–å†™æ€è·¯

è§…å½±è¯é¢‘ç»Ÿè®¡å·¥å…·ä¸»è¦ä¾èµ–äºPythonç¼–ç¨‹è¯­è¨€ï¼Œç»“åˆäº†`tkinter`åº“ç”¨äºæ„å»ºç”¨æˆ·ç•Œé¢ï¼Œ`jieba`åº“ç”¨äºä¸­æ–‡æ–‡æœ¬çš„åˆ†è¯å¤„ç†ï¼Œä»¥åŠ`pandas`åº“æ¥ç®¡ç†æ•°æ®å¹¶å¯¼å‡ºExcelæ–‡ä»¶ã€‚

1. **æ–‡ä»¶éå†ä¸åˆ†è¯**ï¼šä½¿ç”¨osæ¨¡å—éå†æ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰ä¸­æ–‡ txt æ–‡ä»¶ï¼Œç¡®ä¿ä¸é—æ¼ä»»ä½•æ•°æ®ã€‚åŒæ—¶ï¼Œå€ŸåŠ©jiebaåº“è¿›è¡Œä¸­æ–‡åˆ†è¯ï¼Œå°†æ–‡æœ¬å†…å®¹æ‹†åˆ†æˆä¸€ä¸ªä¸ªè¯è¯­ï¼Œä¸ºåç»­çš„å…³é”®è¯ç»Ÿè®¡æ‰“ä¸‹åŸºç¡€ã€‚

2. **æ—¶é—´åˆ—è¡¨ç”Ÿæˆ**ï¼šé€šè¿‡generate_time_listå‡½æ•°ï¼Œæ ¹æ®ç”¨æˆ·è¾“å…¥çš„èµ·å§‹å¹´ä»½å’Œç»“æŸå¹´ä»½ï¼Œç”Ÿæˆç›¸åº”çš„æ—¶é—´åˆ—è¡¨ã€‚è¿™æ ·ï¼Œåœ¨ç»Ÿè®¡è¯é¢‘æ—¶ï¼Œèƒ½å¤ŸæŒ‰ç…§å¹´ä»½é€ä¸€è¿›è¡Œå¤„ç†ï¼Œå®ç°ç²¾å‡†çš„æ—¶é—´ç»´åº¦åˆ†æã€‚

3. **ç»“æœä¿å­˜ä¸å¯è§†åŒ–**ï¼šåˆ©ç”¨pandasåº“å°†ç»Ÿè®¡ç»“æœä¿å­˜ä¸º Excel æ–‡ä»¶ï¼Œå€ŸåŠ©tkinterå’Œttkbootstrapåº“æ­å»ºç”¨æˆ·ç•Œé¢ï¼Œè®©æ“ä½œæ›´åŠ ç®€å•ç›´è§‚ã€‚ç”¨æˆ·åªéœ€è¦åœ¨ç•Œé¢ä¸Šè¾“å…¥ç›¸å…³å‚æ•°ï¼Œç‚¹å‡»æŒ‰é’®ï¼Œå°±èƒ½è½»æ¾å®Œæˆè¯é¢‘ç»Ÿè®¡å’Œæ•°æ®è¾“å‡ºã€‚

## ğŸ“–ä½¿ç”¨æ–¹æ³•

ä½¿ç”¨ â€œè§…å½±è¯é¢‘ç»Ÿè®¡å·¥å…·â€ éå¸¸ç®€å•ã€‚

**æ–¹æ³•ä¸€ï¼š** åœ¨æœ¬æ–‡å¼€å¤´çš„`èµ„æºä¸‹è½½å¯¼èˆªé¡µ`ä¸‹è½½`è§…å½±è¯é¢‘ç»Ÿè®¡å·¥å…·.exe`ï¼Œç›´æ¥åœ¨Windowsç³»ç»Ÿä¸‹ä½¿ç”¨ã€‚

**æ–¹æ³•äºŒï¼š** ä½¿ç”¨æœ¬æ–‡æœ€ä¸‹é¢çš„`æºä»£ç `ï¼Œåœ¨Pythonç¯å¢ƒä¸‹ä½¿ç”¨ã€‚

###  **æ•°æ®å‡†å¤‡**
- ç¡®ä¿æ–‡æœ¬æ•°æ®æŒ‰`å¹´/æœˆ/æ—¥`å±‚çº§å­˜å‚¨ï¼ˆå…¼å®¹äººæ°‘æ—¥æŠ¥çˆ¬è™«æ•°æ®æ ¼å¼ ï¼‰
- æ”¯æŒ`.txt`æ ¼å¼æ–‡ä»¶ï¼Œå»ºè®®å•æ–‡ä»¶å¤§å°<50MB

### **å‚æ•°è®¾ç½®**  
- é€‰æ‹©æ ¹ç›®å½•ï¼ˆåŒ…å«å¹´åº¦å­æ–‡ä»¶å¤¹ï¼‰
- è¾“å…¥å…³é”®è¯ï¼ˆç©ºæ ¼åˆ†éš”ï¼Œå»ºè®®â‰¤20ä¸ªï¼‰
- è®¾ç½®æ—¶é—´èŒƒå›´ï¼ˆæ”¯æŒ1900-2100å¹´ï¼‰

### **è¿è¡Œç»“æœ**
- ç‚¹å‡»"å¼€å§‹ç»Ÿè®¡"åï¼Œå®æ—¶æ˜¾ç¤ºç¨‹åºè¿è¡Œä¿¡æ¯
- è‡ªåŠ¨ç”Ÿæˆ`results.xlsx`æ–‡ä»¶ï¼Œå­˜å‚¨ç»Ÿè®¡çš„æ•°æ®

## ğŸŒˆ ç»“è¯­

æœ¬å·¥å…·ç‰¹åˆ«é€‚åˆå¤„ç†ã€Šäººæ°‘æ—¥æŠ¥ã€‹ç­‰å…·æœ‰æ—¶é—´è¿ç»­æ€§çš„ä¼ ç»Ÿåª’ä½“ç»“æ„åŒ–æ–‡æœ¬æ•°æ®ï¼Œä¹Ÿå¯ä»¥é€‚ç”¨åœ¨ç›¸ä¼¼ç»“æ„çš„æ–‡æœ¬åˆ†æä¸­ï¼Œæ¯”å¦‚åˆ†æå››å…­çº§è€ƒè¯•ä¸­å•è¯æ¯å¹´çš„å‡ºç°é¢‘ç‡ç­‰ï¼Œå…·ä½“ä½¿ç”¨åœºæ™¯æœ‰å¾…å‘æ˜ã€‚

ä»…è¾“å‡ºäº†æœ€åŸºç¡€çš„è¡¨æ ¼æ•°æ®ï¼Œä½†åœ¨æ•°æ®åŸºç¡€ä¸Šè¿›è¡Œå¯è§†åŒ–éƒ½æ˜¯æ›´å®¹æ˜“çš„äº‹æƒ…ï¼Œå°±ä¸ç€æ€¥å¼„äº†ã€‚ä½†è¿˜æœ‰ä¸€ä¸ªé—®é¢˜ä¸å¥½è§£å†³ï¼Œå°±æ˜¯å…³é”®è¯çš„çš„è¯­æ–™åº“éš¾ä»¥æ‰¾åˆ°ï¼Œæ²¡æœ‰èƒ½åŠ›ä¹Ÿæ²¡æœ‰ç²¾åŠ›å»æ„å»ºä¸€ä¸ªç›¸å…³çš„æ”¿æ²»è¯­æ–™åº“ï¼ˆç½‘ä¸Šæœ‰å…¶ä»–ç±»å‹çš„è¯­æ–™åº“ï¼‰ï¼Œä¸”ä¸çŸ¥é“è¯¥å¦‚ä½•åˆ’åˆ†è¯è¯­çš„çƒ­åº¦ç­‰ï¼Œéƒ½æ˜¯æˆ‘æ— æ³•è§£å†³çš„é—®é¢˜ï¼Œç­‰ä¹‹åå†çœ‹å‘å±•å§ã€‚


> æ³¨ï¼šæœ¬å·¥å…·å®Œå…¨å¼€æºï¼Œç¦æ­¢ç”¨äºå•†ä¸šç”¨é€”ã€‚å¦‚éœ€æ·±åº¦å®šåˆ¶æœåŠ¡ï¼Œè¯·é‚®ä»¶è”ç³»ã€‚

## ğŸ‘¨â€ğŸ’» ç¨‹åºæºä»£ç 

```python
import os

import jieba

import pandas as pd

import tkinter as tk

from tkinter import PhotoImage

from PIL import Image, ImageTk

import sys

import argparse

  
  

def generate_time_list(start_year, end_year):

Â  Â  """

Â  Â  ç”Ÿæˆæ—¶é—´åˆ—è¡¨ã€‚

  

Â  Â  :param start_year: èµ·å§‹å¹´ä»½

Â  Â  :param end_year: ç»“æŸå¹´ä»½

Â  Â  :return: æ—¶é—´åˆ—è¡¨

Â  Â  """

Â  Â  return list(range(start_year, end_year + 1))

  
  

def count_keywords_in_files(folder_path, keywords, time_list):

Â  Â  """

Â  Â  ç»Ÿè®¡æ–‡ä»¶å¤¹ä¸‹æ‰€æœ‰ä¸­æ–‡txtæ–‡ä»¶ä¸­å…³é”®è¯çš„å‡ºç°æ¬¡æ•°ã€‚

  

Â  Â  :param folder_path: æ–‡ä»¶å¤¹è·¯å¾„

Â  Â  :param keywords: è¦ç»Ÿè®¡çš„å…³é”®è¯åˆ—è¡¨

Â  Â  :param time_list: æ—¶é—´åˆ—è¡¨

Â  Â  :return: æ¯ä¸ªæ—¶é—´å¯¹åº”çš„æ¯ä¸ªå…³é”®è¯çš„å‡ºç°æ¬¡æ•°åˆ—è¡¨

Â  Â  """

Â  Â  results = {}

Â  Â  for year in time_list:

Â  Â  Â  Â  print(f"æ­£åœ¨å¤„ç† {year} å¹´çš„æ•°æ®...")

Â  Â  Â  Â  year_folder_path = os.path.join(folder_path, str(year))

Â  Â  Â  Â  if os.path.isdir(year_folder_path):

Â  Â  Â  Â  Â  Â  # åˆå§‹åŒ–å…³é”®è¯è®¡æ•°å™¨

Â  Â  Â  Â  Â  Â  keyword_counts = {keyword: 0 for keyword in keywords}

  

Â  Â  Â  Â  Â  Â  # ä½¿ç”¨è¿­ä»£è€Œä¸æ˜¯é€’å½’æ¥éå†æ–‡ä»¶å¤¹å’Œå­æ–‡ä»¶å¤¹

Â  Â  Â  Â  Â  Â  folders_to_visit = [year_folder_path]

Â  Â  Â  Â  Â  Â  while folders_to_visit:

Â  Â  Â  Â  Â  Â  Â  Â  current_path = folders_to_visit.pop()

Â  Â  Â  Â  Â  Â  Â  Â  for item in os.listdir(current_path):

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  item_path = os.path.join(current_path, item)

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if os.path.isfile(item_path) and item.endswith('.txt'):

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  with open(item_path, 'r', encoding='utf-8') as file:

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  content = file.read()

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  # ä½¿ç”¨jiebaè¿›è¡Œåˆ†è¯

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  words = jieba.lcut(content)

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  # ç»Ÿè®¡å…³é”®è¯å‡ºç°æ¬¡æ•°

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  for word in words:

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if word in keyword_counts:

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  keyword_counts[word] += 1

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  elif os.path.isdir(item_path):

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  folders_to_visit.append(item_path)

  

Â  Â  Â  Â  Â  Â  # å°†æ¯ä¸ªæ—¶é—´å¯¹åº”çš„æ¯ä¸ªå…³é”®è¯çš„å‡ºç°æ¬¡æ•°åˆ—è¡¨æ·»åŠ åˆ°ç»“æœä¸­

Â  Â  Â  Â  Â  Â  results[year] = [keyword_counts[keyword] for keyword in keywords]

Â  Â  Â  Â  Â  Â  print(f"{year} å¹´æ•°æ®å¤„ç†å®Œæˆï¼Œå…³é”®è¯ç»Ÿè®¡ç»“æœ: {keyword_counts}")

Â  Â  Â  Â  else:

Â  Â  Â  Â  Â  Â  print(f"è­¦å‘Š: {year} å¹´çš„æ–‡ä»¶å¤¹ä¸å­˜åœ¨ï¼Œå·²è·³è¿‡")

  

Â  Â  return results

  
  

def save_results_to_excel(results, keywords, output_file='results.xlsx'):

Â  Â  """

Â  Â  å°†ç»Ÿè®¡ç»“æœä¿å­˜åˆ°Excelæ–‡ä»¶ä¸­ã€‚

  

Â  Â  :param results: ç»Ÿè®¡ç»“æœ

Â  Â  :param keywords: å…³é”®è¯åˆ—è¡¨

Â  Â  :param output_file: è¾“å‡ºExcelæ–‡ä»¶è·¯å¾„

Â  Â  """

Â  Â  df = pd.DataFrame(results, index=keywords)

Â  Â  df.to_excel(output_file)

Â  Â  print(f"ç»Ÿè®¡ç»“æœå·²ä¿å­˜åˆ° {output_file}")

  
  

def get_resource_path(relative_path):

Â  Â  """è·å–èµ„æºæ–‡ä»¶çš„ç»å¯¹è·¯å¾„ï¼Œå…¼å®¹å¼€å‘ç¯å¢ƒå’Œæ‰“åŒ…åçš„ç¯å¢ƒ"""

Â  Â  try:

Â  Â  Â  Â  if hasattr(sys, '_MEIPASS'):

Â  Â  Â  Â  Â  Â  path = os.path.join(sys._MEIPASS, relative_path)

Â  Â  Â  Â  Â  Â  print(f"å°è¯•ä»_MEIPASSåŠ è½½èµ„æº: {path}")

Â  Â  Â  Â  Â  Â  return path

Â  Â  Â  Â  else:

Â  Â  Â  Â  Â  Â  path = os.path.join(os.path.abspath("."), relative_path)

Â  Â  Â  Â  Â  Â  print(f"å°è¯•ä»å½“å‰ç›®å½•åŠ è½½èµ„æº: {path}")

Â  Â  Â  Â  Â  Â  return path

Â  Â  except Exception as e:

Â  Â  Â  Â  print(f"è·å–èµ„æºè·¯å¾„æ—¶å‡ºé”™: {e}")

Â  Â  Â  Â  return relative_path

  
  

def show_image_window():

Â  Â  """æ˜¾ç¤ºèµèµç çª—å£"""

Â  Â  try:

Â  Â  Â  Â  # åˆ›å»ºä¸€ä¸ªç®€å•çš„Tkçª—å£ç”¨äºæ˜¾ç¤ºèµèµç 

Â  Â  Â  Â  root = tk.Tk()

Â  Â  Â  Â  root.title("èµèµç ")

Â  Â  Â  Â  root.attributes("-topmost", True) Â # è®¾ç½®çª—å£ä¸ºæœ€ä¸Šå±‚

Â  Â  Â  Â  # æ·»åŠ çª—å£å…³é—­äº‹ä»¶å¤„ç†ï¼Œç¡®ä¿ç‚¹å‡»XæŒ‰é’®ä¹Ÿèƒ½æ­£ç¡®é€€å‡º

Â  Â  Â  Â  def on_closing():

Â  Â  Â  Â  Â  Â  root.quit() Â # é€€å‡ºmainloop

Â  Â  Â  Â  Â  Â  root.destroy() Â # é”€æ¯çª—å£

Â  Â  Â  Â  root.protocol("WM_DELETE_WINDOW", on_closing)

  

Â  Â  Â  Â  # è·å–å±å¹•å°ºå¯¸

Â  Â  Â  Â  screen_width = root.winfo_screenwidth()

Â  Â  Â  Â  screen_height = root.winfo_screenheight()

  

Â  Â  Â  Â  # è®¾ç½®å¼¹çª—å°ºå¯¸ä¸ºå±å¹•çš„30%

Â  Â  Â  Â  window_width = int(screen_width * 0.3)

Â  Â  Â  Â  window_height = int(screen_height * 0.45)

  

Â  Â  Â  Â  # è®¡ç®—å¼¹çª—ä½ç½®ï¼Œä½¿å…¶å±…ä¸­æ˜¾ç¤º

Â  Â  Â  Â  x = (screen_width // 2) - (window_width // 2)

Â  Â  Â  Â  y = (screen_height // 2) - (window_height // 2)

  

Â  Â  Â  Â  # è®¾ç½®å¼¹çª—å°ºå¯¸å’Œä½ç½®

Â  Â  Â  Â  root.geometry(f"{window_width}x{window_height}+{x}+{y}")

  

Â  Â  Â  Â  # å°è¯•åŠ è½½PNGå›¾ç‰‡

Â  Â  Â  Â  try:

Â  Â  Â  Â  Â  Â  # æ£€æŸ¥å¯èƒ½çš„å›¾ç‰‡è·¯å¾„

Â  Â  Â  Â  Â  Â  image_paths = [

Â  Â  Â  Â  Â  Â  Â  Â  'èµèµç .png',

Â  Â  Â  Â  Â  Â  Â  Â  './èµèµç .png',

Â  Â  Â  Â  Â  Â  Â  Â  './images/èµèµç .png',

Â  Â  Â  Â  Â  Â  Â  Â  '../èµèµç .png'

Â  Â  Â  Â  Â  Â  ]

Â  Â  Â  Â  Â  Â  image_path = None

Â  Â  Â  Â  Â  Â  for path in image_paths:

Â  Â  Â  Â  Â  Â  Â  Â  print(f"æ£€æŸ¥å›¾ç‰‡è·¯å¾„: {path}, å­˜åœ¨: {os.path.exists(path)}")

Â  Â  Â  Â  Â  Â  Â  Â  if os.path.exists(path):

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  image_path = path

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  break

Â  Â  Â  Â  Â  Â  # å¦‚æœåœ¨å¸¸è§„è·¯å¾„æ‰¾ä¸åˆ°ï¼Œå°è¯•ä½¿ç”¨get_resource_path

Â  Â  Â  Â  Â  Â  if not image_path:

Â  Â  Â  Â  Â  Â  Â  Â  image_path = get_resource_path('èµèµç .png')

Â  Â  Â  Â  Â  Â  Â  Â  if not os.path.exists(image_path):

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  image_path = get_resource_path('images/èµèµç .png')

Â  Â  Â  Â  Â  Â  # å¦‚æœæ‰¾åˆ°å›¾ç‰‡ï¼ŒåŠ è½½å®ƒ

Â  Â  Â  Â  Â  Â  if image_path and os.path.exists(image_path):

Â  Â  Â  Â  Â  Â  Â  Â  print(f"æ­£åœ¨åŠ è½½å›¾ç‰‡: {image_path}")

Â  Â  Â  Â  Â  Â  Â  Â  image = Image.open(image_path)

Â  Â  Â  Â  Â  Â  Â  Â  image = image.resize((300, 300), Image.LANCZOS) Â # è°ƒæ•´å›¾ç‰‡å¤§å°

Â  Â  Â  Â  Â  Â  Â  Â  photo = ImageTk.PhotoImage(image)

  

Â  Â  Â  Â  Â  Â  Â  Â  # åˆ›å»ºä¸€ä¸ªLabelç»„ä»¶æ¥æ˜¾ç¤ºå›¾ç‰‡

Â  Â  Â  Â  Â  Â  Â  Â  image_label = tk.Label(root, image=photo)

Â  Â  Â  Â  Â  Â  Â  Â  image_label.image = photo Â # ä¿æŒå¯¹å›¾ç‰‡çš„å¼•ç”¨

Â  Â  Â  Â  Â  Â  Â  Â  image_label.pack(pady=10)

Â  Â  Â  Â  Â  Â  else:

Â  Â  Â  Â  Â  Â  Â  Â  print(f"æ— æ³•æ‰¾åˆ°å›¾ç‰‡æ–‡ä»¶")

Â  Â  Â  Â  Â  Â  Â  Â  error_label = tk.Label(root, text="æ— æ³•æ‰¾åˆ°èµèµç å›¾ç‰‡", font=('Helvetica', 12))

Â  Â  Â  Â  Â  Â  Â  Â  error_label.pack(pady=10)

Â  Â  Â  Â  except Exception as e:

Â  Â  Â  Â  Â  Â  # å¦‚æœå›¾ç‰‡åŠ è½½å¤±è´¥ï¼Œæ˜¾ç¤ºé”™è¯¯ä¿¡æ¯

Â  Â  Â  Â  Â  Â  print(f"å›¾ç‰‡åŠ è½½å¤±è´¥: {e}")

Â  Â  Â  Â  Â  Â  error_label = tk.Label(root, text=f"å›¾ç‰‡åŠ è½½å¤±è´¥: {e}", font=('Helvetica', 12))

Â  Â  Â  Â  Â  Â  error_label.pack(pady=10)

  

Â  Â  Â  Â  # åˆ›å»ºä¸€ä¸ªLabelç»„ä»¶æ¥æ˜¾ç¤ºæ–‡å­—

Â  Â  Â  Â  text_label = tk.Label(root, text="å¦‚æœå¯¹æ‚¨æœ‰ç”¨ï¼Œæ„Ÿè°¢è¿›è¡Œæ‰“èµã€‚", font=('Helvetica', 12))

Â  Â  Â  Â  text_label.pack(pady=10)

Â  Â  Â  Â  # æ·»åŠ ä¸€ä¸ªæŒ‰é’®ç”¨äºå…³é—­çª—å£

Â  Â  Â  Â  def close_window():

Â  Â  Â  Â  Â  Â  print("ç”¨æˆ·ç‚¹å‡»å…³é—­æŒ‰é’®")

Â  Â  Â  Â  Â  Â  root.quit() Â # é€€å‡ºmainloop

Â  Â  Â  Â  Â  Â  root.destroy() Â # é”€æ¯çª—å£

Â  Â  Â  Â  close_button = tk.Button(root, text="å…³é—­", command=close_window)

Â  Â  Â  Â  close_button.pack(pady=10)

Â  Â  Â  Â  # è¿è¡Œçª—å£çš„äº‹ä»¶å¾ªç¯ï¼Œç­‰å¾…ç”¨æˆ·å…³é—­

Â  Â  Â  Â  root.mainloop()

Â  Â  Â  Â  return root

Â  Â  except Exception as e:

Â  Â  Â  Â  # å¦‚æœå¼¹çª—åˆ›å»ºå¤±è´¥ï¼Œä¸å½±å“ä¸»ç¨‹åºè¿è¡Œ

Â  Â  Â  Â  print(f"èµèµç çª—å£åˆ›å»ºå¤±è´¥: {e}")

Â  Â  Â  Â  import traceback

Â  Â  Â  Â  traceback.print_exc()

Â  Â  Â  Â  return None

  
  

def main():

Â  Â  # æ·»åŠ æ§åˆ¶å°çª—å£ï¼Œä¾¿äºè°ƒè¯•

Â  Â  if hasattr(sys, '_MEIPASS'):

Â  Â  Â  Â  # å¦‚æœæ˜¯æ‰“åŒ…åçš„ç¯å¢ƒï¼Œåˆ›å»ºæ§åˆ¶å°çª—å£

Â  Â  Â  Â  import ctypes

Â  Â  Â  Â  ctypes.windll.kernel32.AllocConsole()

Â  Â  Â  Â  sys.stdout = open('CONOUT$', 'w', encoding='utf-8')

Â  Â  Â  Â  sys.stderr = open('CONOUT$', 'w', encoding='utf-8')

Â  Â  Â  Â  print("ç¨‹åºå¯åŠ¨ï¼Œå·²åˆ›å»ºæ§åˆ¶å°çª—å£ç”¨äºè°ƒè¯•")

Â  Â  # æ˜¾ç¤ºç¨‹åºä»‹ç»

Â  Â  print("="*50)

Â  Â  print("è½¯ä»¶åç§°ï¼šè§…å½±è¯é¢‘ç»Ÿè®¡å·¥å…·")

Â  Â  print("è½¯ä»¶ç‰ˆæœ¬ï¼š1.0.0")

Â  Â  print("ä½œè€…GitHubï¼š@caspiankexin")

Â  Â  print("ä½œè€…é‚®ç®±ï¼šmirror_flower@outlook.com")

Â  Â  print("ç¼–å†™æ—¶é—´ï¼š2025å¹´9æœˆ13æ—¥")

Â  Â  print("ç‰ˆæƒï¼šå…è´¹å¼€æºã€ä¸å¾—å•†ç”¨")

Â  Â  print("å¦‚æœå¯¹æ‚¨æœ‰ç”¨ï¼Œæ„Ÿè°¢è¿›è¡Œæ‰“èµï¼ï¼ï¼")

Â  Â  print("ä½¿ç”¨æ–¹æ³•:")

Â  Â  print(" Â 1. è¾“å…¥éœ€è¦åˆ†æçš„äººæ°‘æ—¥æŠ¥æ•°æ®æ–‡ä»¶å¤¹ï¼Œä»¥2022/2021/2022æ ¼å¼å‘½åå¹´ä»½æ–‡ä»¶å¤¹")

Â  Â  print(" Â 2. è¾“å…¥éœ€è¦æŸ¥è¯¢çš„è¯æ±‡ï¼Œç©ºæ ¼éš”å¼€ï¼Œè¯æ±‡ä¸èƒ½åŒ…å«ç‰¹æ®Šå­—ç¬¦ï¼Œè¾“å…¥çš„è¯æ±‡æ•°é‡æ²¡æœ‰é™åˆ¶")

Â  Â  print(" Â 3. è¾“å…¥èµ·å§‹æ—¶é—´ç‚¹å’Œç»“æŸæ—¶é—´ç‚¹ï¼Œä¾‹å¦‚2002å’Œ2008ï¼Œä¹Ÿå¯ä»¥è¾“å…¥2022å¹´01æœˆå’Œ2022å¹´10æœˆï¼Œä½†éœ€è°ƒæ•´è¾“å…¥çš„æ–‡ä»¶å¤¹")

Â  Â  print(" Â 4. ç»“æœä¿å­˜ä¸ºExcelæ–‡ä»¶ï¼Œä¾¿äºåç»­åˆ†æ")

Â  Â  print(" Â 5. ç¨‹åºå¼€å§‹è¿è¡Œåï¼Œéœ€è€å¿ƒç­‰å¾…ï¼")

Â  Â  print("="*50)

Â  Â  print()

  

Â  Â  # è§£æå‘½ä»¤è¡Œå‚æ•°ï¼Œä»…è·å–no_rewardå‚æ•°

Â  Â  parser = argparse.ArgumentParser(description='è§…å½±è¯é¢‘ç»Ÿè®¡å·¥å…·ï¼šä¸€æ¬¾é’ˆå¯¹æµ·é‡æ–‡æœ¬æ•°æ®è¿›è¡Œè¯é¢‘ç»Ÿè®¡çš„å·¥å…·')

Â  Â  parser.add_argument('--no_reward', action='store_true', help='ä¸æ˜¾ç¤ºèµèµç ')

Â  Â  # ä»…è§£æ--no_rewardå‚æ•°ï¼Œå¿½ç•¥å…¶ä»–å‚æ•°

Â  Â  args, _ = parser.parse_known_args()

Â  Â  # åœ¨ç¨‹åºæœ€å¼€å§‹æ˜¾ç¤ºèµèµç çª—å£

Â  Â  reward_window = None

Â  Â  if not args.no_reward:

Â  Â  Â  Â  try:

Â  Â  Â  Â  Â  Â  reward_window = show_image_window()

Â  Â  Â  Â  except Exception as e:

Â  Â  Â  Â  Â  Â  print(f"èµèµç çª—å£åˆ›å»ºå¤±è´¥: {e}")

Â  Â  Â  Â  Â  Â  import traceback

Â  Â  Â  Â  Â  Â  traceback.print_exc()

Â  Â  # æ‰“å°å½“å‰å·¥ä½œç›®å½•å’Œå¯èƒ½çš„èµ„æºè·¯å¾„

Â  Â  if hasattr(sys, '_MEIPASS'):

Â  Â  Â  Â  print(f"PyInstaller _MEIPASS: {sys._MEIPASS}")

Â  Â  # é‡æ–°è§£ææ‰€æœ‰å‘½ä»¤è¡Œå‚æ•°

Â  Â  parser = argparse.ArgumentParser(description='è§…å½±è¯é¢‘ç»Ÿè®¡å·¥å…·ï¼šä¸€æ¬¾é’ˆå¯¹æµ·é‡æ–‡æœ¬æ•°æ®è¿›è¡Œè¯é¢‘ç»Ÿè®¡çš„å·¥å…·')

Â  Â  parser.add_argument('--folder', type=str, help='æ–‡ä»¶å¤¹è·¯å¾„')

Â  Â  parser.add_argument('--keywords', type=str, help='è¦ç»Ÿè®¡çš„å…³é”®è¯ï¼Œç”¨ç©ºæ ¼åˆ†éš”')

Â  Â  parser.add_argument('--start_year', type=int, help='èµ·å§‹å¹´ä»½')

Â  Â  parser.add_argument('--end_year', type=int, help='ç»“æŸå¹´ä»½')

Â  Â  parser.add_argument('--output', type=str, default='results.xlsx', help='è¾“å‡ºExcelæ–‡ä»¶è·¯å¾„')

Â  Â  parser.add_argument('--no_reward', action='store_true', help='ä¸æ˜¾ç¤ºèµèµç ')

Â  Â  args = parser.parse_args()

Â  Â  # å¦‚æœæ²¡æœ‰æä¾›å‘½ä»¤è¡Œå‚æ•°ï¼Œåˆ™äº¤äº’å¼è¾“å…¥

Â  Â  folder_path = args.folder

Â  Â  keywords = args.keywords.split() if args.keywords else None

Â  Â  start_year = args.start_year

Â  Â  end_year = args.end_year

Â  Â  output_file = args.output

Â  Â  if not folder_path:

Â  Â  Â  Â  print("="*50)

Â  Â  Â  Â  folder_path = input("è¯·è¾“å…¥éœ€è¦å¤„ç†çš„æ•°æ®çš„æ–‡ä»¶å¤¹çš„è·¯å¾„: ")

Â  Â  if not keywords:

Â  Â  Â  Â  keywords_input = input("è¯·è¾“å…¥è¦ç»Ÿè®¡çš„å…³é”®è¯ï¼Œç”¨ç©ºæ ¼åˆ†éš”: ")

Â  Â  Â  Â  keywords = keywords_input.strip().split()

Â  Â  if not start_year:

Â  Â  Â  Â  start_year = int(input("è¯·è¾“å…¥èµ·å§‹å¹´ä»½: "))

Â  Â  if not end_year:

Â  Â  Â  Â  end_year = int(input("è¯·è¾“å…¥ç»“æŸå¹´ä»½: "))

Â  Â  print(f"\nå¼€å§‹ç»Ÿè®¡...")

Â  Â  print(f"æ–‡ä»¶å¤¹è·¯å¾„: {folder_path}")

Â  Â  print(f"å…³é”®è¯: {keywords}")

Â  Â  print(f"å¹´ä»½èŒƒå›´: {start_year}-{end_year}")

Â  Â  # ç”Ÿæˆæ—¶é—´åˆ—è¡¨

Â  Â  time_list = generate_time_list(start_year, end_year)

Â  Â  # ç»Ÿè®¡å…³é”®è¯

Â  Â  print("\nå¼€å§‹ç»Ÿè®¡å…³é”®è¯å‡ºç°æ¬¡æ•°...")

Â  Â  results = count_keywords_in_files(folder_path, keywords, time_list)

Â  Â  # ä¿å­˜ç»“æœ

Â  Â  print("\næ­£åœ¨ä¿å­˜ç»“æœåˆ°Excelæ–‡ä»¶...")

Â  Â  save_results_to_excel(results, keywords, output_file)

Â  Â  print(f"\nç»Ÿè®¡å®Œæˆï¼ç»“æœå·²ä¿å­˜åˆ° {output_file}")

Â  Â  # å¦‚æœæ²¡æœ‰æ˜¾ç¤ºèµèµç çª—å£ï¼Œç­‰å¾…ç”¨æˆ·è¾“å…¥

Â  Â  if not reward_window:

Â  Â  Â  Â  input("æŒ‰Enteré”®é€€å‡º...")

  
  

if __name__ == "__main__":

Â  Â  main()

```
---

å¦‚æœå¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œæ„Ÿè°¢æ‰“èµï¼ğŸ™‡â€â™€ï¸ğŸ¤—ğŸ«¡

 <img src="https://image.062898.xyz/2025/02/303b772de64207e28de06464675078b4.webp" width="250" />

